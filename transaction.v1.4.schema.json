{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "http://api.itembase.io/v1/transaction.v1.4.schema.json",
  "type": "object",
  "properties": {
    "id": {
      "id": "id",
      "type": "string",
      "description": "A hash of the original_reference and the source_id. Unique."
    },
    "source_id": {
      "id": "source_id",
      "type": "string",
      "description": "An alphanumerical string that identifies the source of this transaction. All entities that are generated by the same connection will have the same source_id."
    },
    "original_reference": {
      "id": "original_reference",
      "type": "string",
      "description": "The original identifier in the data source, i. E. on the platform, in the shop system."
    },
    "created_at": {
      "id": "created_at",
      "type": "string",
      "pattern": "^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z)$"
    },
    "updated_at": {
      "id": "updated_at",
      "type": "string",
      "pattern": "^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z)$"
    },
    "currency": {
      "id": "currency",
      "type": "string",
      "pattern": "^[A-Z]{3}$",
      "description": "An ISO4217 currency code."
    },
    "total_price": {
      "id": "total_price",
      "type": "number",
      "description": "The total price of this transaction including taxes, shipping etc.",
      "minimum": 0
    },
    "total_price_net": {
      "id": "total_price_net",
      "type": "number",
      "description": "The total price of this transaction without taxes.",
      "minimum": 0
    },
    "total_tax": {
      "id": "total_tax",
      "type": "number",
      "description": "The total taxes paid for this.",
      "minimum": 0
    },
    "status": {
      "id": "status",
      "type": "object",
      "properties": {
        "global": {
          "id": "global",
          "type": "string",
          "enum": [
            "open",
            "completed",
            "cancelled"
          ]
        },
        "payment": {
          "id": "payment",
          "type": "string",
          "enum": [
            "not_paid",
            "processing",
            "partial",
            "paid",
            "cancelled",
            "refunded"
          ]
        },
        "shipping": {
          "id": "payment",
          "type": "string",
          "enum": [
            "not_shipped",
            "pickpack",
            "pending",
            "partial",
            "completed",
            "returned"
          ]
        }
      },
      "required": [
        "global"
      ]
    },
    "products": {
      "id": "products",
      "type": "array",
      "items": {
        "allOf": [
          {
            "$ref": "product.v1.2.schema.json#"
          },
          {
            "properties": {
              "quantity": {
                "id": "quantity",
                "type": "number",
                "minimum": 0
              },
              "total_line_items": {
                "id": "total_line_items",
                "type": "number",
                "description": "The total of this line item including taxes.",
                "minimum": 0
              },
              "tax_rate": {
                "id": "tax_rate",
                "type": "number",
                "description": "The tax rate in percent, i.E. from 0 to 100.",
                "minimum": 0,
                "maximum": 100
              },
              "total_line_items_tax": {
                "id": "total_line_items_tax",
                "type": "number",
                "description": "The total tax of this line item.",
                "minimum": 0
              },
              "shipping_provider": {
                "id": "shipping_provider",
                "type": "string",
                "description": "The name of the shipping service selected, as provied by the source."
              },
              "tracking_url": {
                "id": "tracking_url",
                "type": "string",
                "pattern": "^(https?|ftp):\/\/.+$",
                "description": "A URL to the shipment tracking."
              }
            },
            "required": [
              "quantity",
              "total_line_items",
              "tax_rate",
              "total_line_items_tax"
            ]
          }
        ]
      }
    },
    "shipping": {
      "id": "shipping",
      "type": "object",
      "description": "Contains this shipping destination and the cost of shipping to this address.",
      "allOf": [
        {
          "$ref": "address.v1.2.schema.json#"
        },
        {
          "properties": {
            "price": {
              "id": "price",
              "type": "number",
              "minimum": 0
            }
          },
          "required": [
            "price"
          ]
        }
      ]
    },
    "billing": {
      "$ref": "address.v1.2.schema.json#"
    },
    "buyer": {
      "$ref": "buyer.v1.2.schema.json#"
    }
  },
  "required": [
    "id",
    "source_id",
    "original_reference",
    "created_at",
    "currency",
    "total_price",
    "total_price_net",
    "total_tax",
    "status",
    "products",
    "buyer"
  ]
}
